---
toc: true
layout: post
comments: false
author: Robot_No.412
title: Jeykll+Github Page 搭建一个 blog
date: 2021-10-26
permalink: 2021_BuildBlog
tags: 
    - blog
    - GitHub Actions
excerpt: 又又又弄好了一个 blog ，这次应该是最后一次了，吧？算了，不考虑这么多，记录一下怎么弄的吧，省得以后又要再找一遍教程。
---

本来一开始计划是用 Github Actions + Hexo 自动化渲染的，但是折腾了一天多都没有弄明白那个配置文件和 workflows 要怎么编辑。其实现在想想，应该是环境没有配置好，应该要本地配置好预览没问题之后再上传，之后再编辑 workflows 文件就可以自动化渲染了。不过懒得再去折腾一遍电脑了，本地并没有相应的环境也不想重新下载安装，所以放弃了。不过这过程中，了解到其实 Github Pages 其实可以用 jekyll 来自动渲染。而且，jekyll 本身也有不少好看主题，配置起来超级简单：fork 主题-修改配置-上传。这样就自动化配置好了 Github Pages。本着多一事不如少一事的原则，果断选择了 jekyll。

## 主题仓库

这里选择了一个国人的主题，仿的 LOFFER，不得不说还是挺耐看的。[主题地址](https://github.com/FromEndWorld/LOFFER)

而且不得不说，这个作者真的是细心，不愧是小姐姐。配置文件注释得特别详细，虽然更进阶的用法并没有标注出来，但是对没基础的小白来说，按照作者的注释去修改文件就完全可以正常使用了。

### 修改配置文件

虽然作者的注释很详细，不过想要更加自定义一点的话，还是需要改动一些作者并没有注释到的东西。配置文件位置在仓库路径`/_config.yml_`。

#### 添加 RSS feed 订阅按键

本来以为是需要自己添加代码来加上 feed 功能的，不过搜索了一下发现虽然不像教程在仓库根目录找到`feed.yml`文件，但是搜索一下发现有关于 feed 的 url 配置。试了一下 url+feed.xml，居然是可用的，那么说明配置文件就不需要更改了，只要添加一个按键就好了。

在`_config.yml`文件中，站点页脚修改加上一个`<a href="/feed.xml">RSS</a>`就好了。不像教程里面那样添加`<a href="{{ site.url }}/feed.xml">RSS 订阅</a>`，因为配置文件里面是没法定义`site.url`这个值的，这样加上去最后点击链接就会变成`http(s)://your.url/{{ site.url }}/feed.xml`的形式，所以只要一个 /feed.xml 就刚刚好了。

#### 开启 CDN 加速

这个太麻烦了，弃了，仔细想想这个也不是很有必要的东西。文字加载不会太慢，图片的话，非必要不上图+上传之前尽量压缩一点就好了。不是很重要的图完全可以找到什么图床就好了，记得多留一份备份就行。

#### 一些需要注意的坑

1. **url**：如果要自定义域名的话，务必写完整，加上开头的`http(s)://`，不然后面点击文章，链接都会变成`http(s)://your.url/url/你文章标题链接`。就是简单的会把你的域名当做文章标题链接父目录，别问我怎么发现这个坑的。
2. 菜单按钮如果要排序的话，直接修改配置文件里面的顺序就好了，记得保持 name 和 url 的一一对应。

## 写文的格式要求

其实就个人来说，肯定就是直接 md 就好了。说实话 md 的话就没有太多需要注意的地方了，不过和本地相比还是有一点区别的，这里面实在是有不少坑，不得不注意。建议的话，如果不是必要，可以不用往下看怎么折腾了。

创建 post 只需要在_posts目录下新建个文件即可，这个文件需要遵循一定的命名格式，这是 jekyll 要求的，格式为 `YEAR-MONTH-DAY-title.MD`。title 可以是中文也可以是英文，不过中文的话首先链接就会变得不美观，部分时候看起来会变成乱码一样的东西，其次就是部分场景下中文链接会报错。避免麻烦还是英文数字不要空格。

### 图床

文章内容的话，就没有太多需要注意的地方，唯一一个点就是图片。如果有合适的图床的话，那么直接用图床就好了。免费的 [sm.ms](https://sm.ms)，收费的各种云，自建等等都可以。实在不行，找各种教程用 GitHub 仓库搭一个也不是不可以，虽然速度可能不太好但是至少稳定不至于跑路，速度问题也可以套个 CDN 加速（请勿滥用）。

然而，就算有这么多方便快捷不坑的方法，我还是决定不用。可能这就是 21 世纪新青年的蛋疼心态吧。我选择了一个最麻烦的方法，仓库根目录建一个目录用来放图片。其实本质上和 GitHub 图床是一样的，不过不需要单独建立一个仓库，这样文件和图片都在一个仓库，看起来心里面会舒服一点~~什么奇怪毛病~~。

这样的话，其实引用图片有两个方法：一个是完整链接（绝对引用），缺点是不能方便预览需要先传图然后再使用，而且速度不一定好；一个是相对地址（相对引用），优点是本地可以预览~~只要不是像我一个毛病多，非要和 Obsidian 联动的话，相对地址就不会有什么问题。~~。那么这个坑在哪里呢？就是这个相对引用，因为本地是使用 Obsidian 管理所有的 md 文件，建立了一个库。然后习惯就是以月份为文件夹，下面新建`Pic`文件夹统一放置整个月的图片实现相对引用。看起来很美好，但是一旦这个和 blog 的仓库联动起来就很蛋疼了。现在的文件夹结构是这样的：

```yml
父目录/
	-年份子目录/
		-月份子目录/
			-Pic/ 
				1.png
				2.png
			1.md
			2.md
	-_post/
		1.md
	-Pic/
		1.png
```

这样的话，所有 post 里面的 md 文件，要引用 Pic/ 里面图片，必要需要这样写：`/Pic/1.png`，不然网站上面就看不到图片。但是这样写，Obsidian 就没法看到图片。不过幸好，这种事情不是很麻烦，本地的时候只要写成`Pic/1.png`发布之前统一替换一下就好而。

### fornt-matter 格式

先解释一下为什么要有 fornt-matter。简单来说就是，所有的博客文件必须以YAML front-matter开头。（逃

各种尝试了半天，把主题作者说了并且支持的项目，不支持也没说的项目和支持但是没有说的项都试了一遍，应该差不多就是完整的了吧？

```yaml
---
layout: #布局文件，layouts/文件夹下面，这个主题限制必须是：post
title: #标题，这个不受文件名影响，文章最后实际显示标题为这个
date: #日期
author: #作者
permalink: #静态链接，里面最后不要使用英文句号'.'，不然文章链接容易无效
published: #是否发布文章，true/false
categories: #类别，这个应该是支持但是主题里面并没有这个项，所以开启了也没啥用。而且个人觉得，类别和标签的功能上有些重复冗余，可以不要
tags: 
#标签，可以用[tag1, tag2]或者
#tags: 
#    - tag1
#    - tag2
#这里面有个坑，`- tag1`前面的缩进，必须是四个空格，不能用 tab 代替，不然这个 fornt-matter 就是无效的，所有设置都不会生效
comments: #评论，true/false，具体配置需要看作者原文
pinned: #置顶，true/false
excerpt: #摘要，也可以在正文中通过 <!-- more --> (此值由_config.yml设置)来选定
toc: #开启目录，true/false
---
```

### 总结

其实这样就可以开始了，对于内容输出平台来说，最重要的事情是持续有效的产出，其他的都是辅助产出，切不可本末倒置。

关于和 Obsidian 联动，其实就是通过 Windows 的目录链接方式把一个文件夹同时链接到两个不同的地方方便不同的软件分别管理。具体内容不展开了，不过姑且还是备份一下链接吧。

### 参考链接

1. https://fromendworld.github.io/LOFFER/document/ | 主题文档
2. https://night1008.github.io/2019/11/09/jekyll-add-rss-feed.html | 为 Jekyll 博客添加 RSS feed 订阅功能
3. https://mazhuang.org/2020/10/07/cdn-for-github-pages-2/ | CDN 加速
4. https://daemon369.github.io/blog/2013/09/13/jekyll-document-04-front-matter | Jekyll 文档——Front-matter，这里面其他内容有兴趣也可以研究一下，有一个系列关于 Jekyll 的。
5. https://sspai.com/post/66834 | 关于 Windows 上软链接和硬链接的